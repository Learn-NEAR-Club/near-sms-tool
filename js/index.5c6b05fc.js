(function(t){function e(e){for(var i,o,r=e[0],c=e[1],l=e[2],d=0,m=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(m.length)m.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},s={index:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0094":function(t,e,n){t.exports=n.p+"img/lock.3d55978f.svg"},"0104":function(t,e,n){},"0773":function(t,e,n){t.exports=n.p+"img/toggle.a04685e8.svg"},"0ac3":function(t,e,n){"use strict";n("6f6b")},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},14:function(t,e){},15:function(t,e){},16:function(t,e){},"16a5":function(t,e,n){"use strict";n("c968")},17:function(t,e){},2:function(t,e){},"209b":function(t,e,n){"use strict";n("af90")},"220d":function(t,e,n){t.exports=n.p+"img/connect.9fc735ec.svg"},"2fdc":function(t,e,n){"use strict";n("e32e")},3:function(t,e){},4:function(t,e){},"40e0":function(t,e,n){t.exports=n.p+"img/inbox.661c10e6.svg"},"41e0":function(t,e,n){"use strict";n("6de8")},"44c7":function(t,e,n){t.exports=n.p+"img/icon.9025776e.svg"},5:function(t,e){},"53c1":function(t,e,n){"use strict";n("61f4")},5648:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"root"}},[n("Convert"),n("ConfirmPasswordModal",{attrs:{showModalConfirm:t.showModalPassword,onPasswordConfirm:t.onPasswordConfirm},on:{toggleConfirmPasswordModal:function(e){return t.toggleConfirmPasswordModal(e)}}})],1)},a=[],o=(n("99af"),n("caad"),n("2532"),n("0104"),n("db49")),r=n.n(o),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"content-area"},[n("Sidebar"),n("MailContent")],1),n("FooterMobile")],1),n("SentMessageModal"),n("AlertModal"),n("KeyManagementModal"),n("Overlay")],1)},l=[],u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[{active:t.activeMobileMenu},"mail-left"]},[t._m(0),i("div",{staticClass:"mail-left__compose"},[i("button",{staticClass:"btn-mail btn-mail__sent btn-compose cursor-pointer",on:{click:t.handleSendMessageModal}},[t._m(1)])]),i("div",{staticClass:"mail-left__menu hidden-sm"},[i("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[i("router-link",{staticClass:"mail-left__menu-item mb-10 d-flex align-center justify-between",class:{active:"/inbox"===t.$route.path||"/"===t.$route.path},attrs:{to:"/inbox"}},[i("span",{staticClass:"d-flex align-center"},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("40e0")}}),i("span",{staticClass:"ml-20 title"},[t._v("Inbox")])]),i("span",{staticClass:"letter-spacing-5"},[t._v(t._s(t.inboxMsgNum))])])],1),i("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[i("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-between",class:{active:"/sent"===t.$route.path},attrs:{to:"/sent"}},[i("span",{staticClass:"d-flex align-center"},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("8f55")}}),i("span",{staticClass:"ml-20 title"},[t._v("Sent")])]),i("span",{staticClass:"letter-spacing-5"},[t._v(t._s(t.sentMsgNum))])])],1)]),i("div",{staticClass:"mail-left__static d-flex justify-center flex-column pl-10"},[i("div",{staticClass:"mb-16 d-flex align-start"},[i("div",{staticClass:"theme-change"},[i("label",{staticClass:"switch-theme"},[i("input",{staticClass:"input__switch-theme",attrs:{type:"checkbox"},domProps:{checked:t.darkMode},on:{click:t.handleToggleDarkMode}}),i("span",{staticClass:"slider"})])]),i("div",{staticClass:"lock d-flex align-center justify-center ml-20 cursor-pointer",class:[{"is-hidden":!t.isLoggedIn}],on:{click:t.showKeyModal}},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("0094")}})])]),i("div",{staticClass:"f-12 f-500 mb-30 mb-sm-0"},[t._m(2),i("div",{staticStyle:{"padding-left":"10px"}},[i("div",[t._v(t._s(t.statics.activeAccount)+" active accounts,")]),i("div",[t._v(t._s(t.statics.totalsAccount)+" total accounts,")]),i("div",[t._v(t._s(t.statics.messages)+" messages.")])])]),t._m(3)]),i("div",{staticClass:"mail-left__connect"},[i("button",{class:[{"is-hidden":t.isLoggedIn},"btn-mail cursor-pointer btn-connect"],on:{click:t.handleAuth}},[t._m(4)]),i("div",{class:[{"is-hidden":!t.isLoggedIn},"mail-left__info"]},[i("div",{staticClass:"is-hidden block-sm f-12"},[t._v("Wallet connected:")]),i("div",{staticClass:"d-flex pl-10 pl-sm-0"},[t._m(5),i("div",{staticClass:"pl-8 pr-20 flex-grow-1"},[i("div",{staticClass:"name title-16 f-700 mb-4"},[t._v(t._s(t.username))]),i("div",{staticClass:"f-500"},[t._v("Balance: "+t._s(t.balance)+" NEAR")])]),i("span",{staticClass:"p-relative cursor-pointer",staticStyle:{top:"3px"},on:{click:t.handleLogOut}},[i("svg",{staticClass:"flex-shrink-0",attrs:{width:"16",height:"15",viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M4.8 6.3999L4.8 7.9999L12 7.9999L12 10.3999L16 7.1999L12 3.9999L12 6.3999L4.8 6.3999Z",fill:"#888A90"}}),i("path",{attrs:{d:"M1.5999 14.3999L8.7999 14.3999C9.6823 14.3999 10.3999 13.6823 10.3999 12.7999L10.3999 9.5999L8.7999 9.5999L8.7999 12.7999L1.5999 12.7999L1.5999 1.5999L8.7999 1.5999L8.7999 4.7999L10.3999 4.7999L10.3999 1.5999C10.3999 0.717502 9.6823 -9.82912e-05 8.7999 -9.83683e-05L1.5999 -9.89978e-05C0.717504 -9.90749e-05 -9.60786e-05 0.717501 -9.61558e-05 1.5999L-9.71349e-05 12.7999C-9.7212e-05 13.6823 0.717503 14.3999 1.5999 14.3999Z",fill:"#888A90"}})])])])])])])},d=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"logo d-flex align-center justify-between"},[i("div",{staticClass:"d-flex align-center"},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("5f2b")}}),i("span",{staticClass:"\n          text-logo\n          title-16\n          f-700 f-obi\n          ml-10\n          letter-spacing-5\n          text-justify\n        "},[t._v(" Near Messaging Service ")])]),i("div",{staticClass:"flex-shrink-0 is-hidden block-sm"},[i("img",{staticClass:"logo-dark",attrs:{src:n("fb89")}}),i("img",{staticClass:"logo-light",attrs:{src:n("5b81")}})])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[i("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("6e81")}}),i("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("619a")}}),i("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20 ml-sm-10"},[t._v(" COMPOSE ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b",[t._v("Statics:")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"hidden-sm"},[i("img",{staticClass:"logo-dark",attrs:{src:n("fb89")}}),i("img",{staticClass:"logo-light",attrs:{src:n("5b81")}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[i("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("220d")}}),i("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("67b5")}}),i("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20"},[t._v(" CONNECT ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex-shrink-0"},[n("span",{staticClass:"status background-active"})])}],m=n("1da1"),h=(n("96cf"),n("b680"),n("ac1f"),n("5319"),n("d9eb")),f=n("9dcd"),p=n.n(f),v=r()("development"),g=(60*Math.pow(10,12)).toFixed(),w=(Math.pow(10,24),function(t){return p()(t||"0").times(Math.pow(10,24)).toFixed()}),b=null,_=function(t){return p()(t||"0").div(Math.pow(10,24)).toFixed(4)};function M(){return C.apply(this,arguments)}function C(){return C=Object(m["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(h["connect"])(Object.assign({deps:{keyStore:new h["keyStores"].BrowserLocalStorageKeyStore}},v));case 2:return e=t.sent,b=e,window.walletConnection=new h["WalletConnection"](e),window.accountId=window.walletConnection.getAccountId(),t.next=8,new h["Contract"](window.walletConnection.account(),v.contractName,{viewMethods:["getStaticsInfo","getSentMsgNum","getSentMessages","getInboxMsgNum","getInboxMessages","getMessage","getStatics","getPublicKey"],changeMethods:["sendMessage","updatePublicKey","sendBack"]});case 8:window.contract=t.sent;case 9:case"end":return t.stop()}}),t)}))),C.apply(this,arguments)}function y(){window.walletConnection.signOut(),window.location.replace(window.location.origin+window.location.pathname)}function x(){window.walletConnection.requestSignIn(v.contractName)}function k(t,e,n){var i={fromIndex:0,toIndex:-1};return t>0&&(t<n?(i.fromIndex=0,i.toIndex=t-1):(i.toIndex=t-1-(e-1)*n,i.fromIndex=i.toIndex-n+1,i.fromIndex<0&&(i.fromIndex=0))),i}function I(t,e){try{var n='{\n          "contract": "alpha.neatar.testnet",\n          "method": "avatar_of",\n          "params": { "account_id": "'.concat(t,'" },\n          "rpc_node": "https://rpc.testnet.near.org"\n      }'),i="https://rest.nearapi.org/view",s=new XMLHttpRequest;s.open("POST",i),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-Type","application/json"),s.onreadystatechange=function(){4===s.readyState&&e(s.responseText)},s.send(n)}catch(a){console.error("Unable to get avatar",a),e(null)}}function S(t){return E.apply(this,arguments)}function E(){return E=Object(m["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!1,t.prev=1,t.next=4,b.connection.provider.query("account/".concat(e),"");case 4:n=!0,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](1),console.error(t.t0);case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,null,[[1,7]])}))),E.apply(this,arguments)}var P={data:function(){return{statics:{activeAccount:0,totalsAccount:0,messages:0},balance:0}},computed:{isLoggedIn:function(){return this.$store.state.auth.auth.isLogin},activeMobileMenu:function(){return this.$store.state.activeMobileMenu},username:function(){return window.walletConnection.getAccountId()},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},darkMode:function(){return this.$store.state.darkMode}},mounted:function(){this.getSentMessageNum(),this.getInboxMessageNum(),this.getStatics(),this.getBalance(),this.checkInboxMsgNum(),this.checkBalance()},watch:{isLoggedIn:{immediate:!0,handler:function(){var t=localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"));t&&this.$store.commit("TOGGLE_PRIVATEKEY_LOCAL",{key:t,userName:this.username})}}},methods:{handleAuth:function(){x()},handleLogOut:function(){y()},handleToggleDarkMode:function(){this.$store.commit("TOGGLE_DARK_MODE")},handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleResetSelectedMailId:function(){this.$store.commit("RESET_MESSAGE_CONVERSATION",null)},getSentMessageNum:function(){var t=this;window.contract.getSentMsgNum({accountId:this.username}).then((function(e){t.$store.commit("SET_SENT_MSG_NUM",e)}))},getInboxMessageNum:function(){var t=this;window.contract.getInboxMsgNum({accountId:this.username}).then((function(e){t.$store.commit("SET_INBOX_MSG_NUM",e)}))},getStatics:function(){var t=this;window.contract.getStatics().then((function(e){t.statics.activeAccount=e.sentAccountNum,t.statics.totalsAccount=e.accountNum,t.statics.messages=e.messageNum}))},getBalance:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLoggedIn){e.next=9;break}return e.next=3,window.walletConnection.account("example-account.testnet");case 3:return n=e.sent,e.next=6,n.getAccountBalance();case 6:i=e.sent,((null===i||void 0===i?void 0:i.available)||0)/Math.pow(10,24),t.balance=h["utils"].format.formatNearAmount((null===i||void 0===i?void 0:i.available)||0,2);case 9:return e.abrupt("return",0);case 10:case"end":return e.stop()}}),e)})))()},checkInboxMsgNum:function(){var t=this,e="60000";window.setInterval((function(){t.getInboxMessageNum()}),parseInt(e))},checkBalance:function(){var t=this;window.setInterval((function(){t.getBalance()}),3e4)},showKeyModal:function(){this.$store.commit("TOGGLE_KEY_MODAL")}}},A=P,T=(n("ad0b"),n("2877")),R=Object(T["a"])(A,u,d,!1,null,"360a2a70",null),N=R.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mail-content-container flex-grow-1"},[i("div",{staticClass:"mail-content__col mail-content__component",class:{"d-none":t.windowWidth<=1024&&t.msgInboxId}},[i("header",{staticClass:"mail-content__header"},[i("div",{staticClass:"mail-content__header-col"},[i("div",{staticClass:"mail-content__header-title f-700 mb-4 d-flex align-center"},[i("img",{staticStyle:{"max-width":"29px"},attrs:{src:n("5f2b")}}),t._v(" "+t._s(t.routePathSent?"Sent":"Inbox")+" ")]),i("div",{staticClass:"f-500 mb-30 mb-md-16 mb-sm-0"},[i("span",[t._v(" "+t._s(t.routePathSent?t.sentMsgNum:t.inboxMsgNum)+" ")]),t._v(" Messages ")])]),i("div",{staticClass:"\n          d-flex\n          align-center\n          justify-between\n          mail-content__header-col mail-content__header-col-right\n        "},[i("div",{staticClass:"d-flex align-center no-wrap text-right top"},[i("div",[t._v("Page "+t._s(t.page))]),i("div",{staticClass:"mail-content__button hidden-sm ml-20 mr-20 ml-sm-6 mr-sm-0"},[i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:t.page>1,expression:"page > 1"}],staticClass:"mail-content__button-prev cursor-pointer mr-4 mr-sm-16",on:{click:function(e){return t.prevPage()}}}),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.reachMaxPage&&!t.preventPagination,expression:"!reachMaxPage && !preventPagination"}],staticClass:"mail-content__button-next cursor-pointer",on:{click:function(e){return t.nextPage()}}})])])])])]),i("div",{class:[{"is-hidden":t.userLogin},"title-16 f-700 mail-content__list-none"]},[t._v(" Connect your NEAR wallet to start using NEAR Messaging Service! ")]),t.userLogin?i("router-view"):t._e()],1),i("AllMessages")],1)},L=[],$=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__col mail-right",class:{"d-block":t.windowWidth<=1024&&t.msgInboxId}},[t._m(0),n("section",{class:[{"is-hidden":!t.userLogin},"mail-right__body"]},[n("div",{class:[{"is-hidden":t.msgInboxId},"mail-right__no-selected"]},[t._v(" No conversations selected. ")]),n("div",{class:[{"is-hidden":!t.msgInboxId},"mail-right__selected scrollbar"]},t._l(t.dataMsgConversation,(function(t){return n("MessageDetail",{key:t.id,attrs:{from:t.from,dataMsg:t}})})),1)])])}),K=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"mail-right__header"},[i("div",{staticClass:"mail-right__header-title f-700 mb-4 d-flex align-center"},[i("img",{staticClass:"is-hidden block-sm mr-sm-10",staticStyle:{"max-width":"29px"},attrs:{src:n("5f2b")}}),t._v(" Message conversation ")]),i("div",{staticClass:"f-500"},[t._v("Message conversation history.")])])}],j=n("2909"),F=(n("fb6a"),n("e9c4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("article",{staticClass:"mail-right__item"},[i("header",{staticClass:"mail-right__item-header d-flex"},[i("Avatar",{attrs:{accountId:t.from,size:"60"}}),i("div",{staticClass:"info pl-30 pl-xl-16 pl-md-16 pl-sm-10 flex-grow-1 d-flex justify-between"},[i("div",[i("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.dataMsg.from))]),i("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.dataMsg.to))])]),i("div",{staticClass:"text-right"},[i("div",{staticClass:"action mb-10 mb-sm-4 d-flex",staticStyle:{position:"relative"}},[i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"action-sent reply cursor-pointer d-flex align-center mr-40 mr-xl-20 md-md-20 md-sm-20",on:{click:t.handleShowReply}},[i("svg",{staticClass:"mr-10",attrs:{width:"28",height:"20",viewBox:"0 0 28 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M28 20C28 20 25.3167 5.55556 11.6667 5.55556V0L0 10L11.6667 19.3333V12.9236C19.075 12.9236 24.1354 13.5417 28 20Z",fill:"#3B4551"}})]),t._v(" Reply "),i("span",{directives:[{name:"show",rawName:"v-show",value:this.handleCheck(),expression:"this.handleCheck()"}],staticClass:"coin-info",on:{mouseover:function(e){t.showTooltip=!0},mouseleave:function(e){t.showTooltip=!1}}},[t._v(" "+t._s(this.handleCalculateReceivedAmount())+"N")])])]),i("div",{staticClass:"action-sent forward cursor-pointer d-flex align-center",on:{click:t.handleShowForward}},[t._v(" Forward "),i("svg",{staticClass:"ml-10",attrs:{width:"28",height:"20",viewBox:"0 0 28 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M0 20C0 20 2.68333 5.55556 16.3333 5.55556V0L28 10L16.3333 19.3333V12.9236C8.925 12.9236 3.86458 13.5417 0 20Z",fill:"#3B4551"}})])]),i("Tooltip",{attrs:{isShow:this.showTooltip}},[t._v(" Reply this message to get "+t._s(this.handleCalculateReceivedAmount())+" NEAR now! ")])],1),i("div",{staticClass:"f-500 date"},[t._v(t._s(t.dataMsg.timestamp.toLocaleString()))])])])],1),i("section",{staticClass:"mail-right__item-body"},[i("div",{class:{isPrivate:t.dataMsg.isPrivate}},[t.dataMsg.isPrivate?i("img",{staticClass:"private-message",attrs:{src:n("90dc")}}):t._e(),i("div",{staticClass:"title cursor-pointer",on:{click:function(e){t.showDetail=!t.showDetail}}},[t._v(" Title: "+t._s(t.dataMsg.title)+" ")])]),i("div",{staticClass:"description f-500"},[i("div",{staticClass:"content"},[i("TipTap",{attrs:{modelValue:t.dataMsg.content,isDetail:!0}})],1)]),i("ReplyMessage",{class:{"is-hidden":!t.showReply},attrs:{id:t.dataMsg.id,title:t.dataMsg.title,to:t.dataMsg.from,from:t.dataMsg.to,showReply:t.showReply},on:{cancelReplay:t.cancelReplay}}),i("ForwardMessage",{class:{"is-hidden":!t.showForward},attrs:{id:t.dataMsg.id,title:t.dataMsg.title,to:t.dataMsg.to,from:t.dataMsg.from,showForward:t.showForward},on:{cancelForward:t.cancelForward}})],1)])}),D=[],G=(n("a9e3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mail-right__sent"},[i("header",{staticClass:"mail-right__item-header d-flex"},[i("Avatar",{attrs:{accountId:t.from,size:"60"}}),i("div",{staticClass:"info pl-30 pl-xl-16 pl-md-16 pl-sm-10 flex-grow-1 d-flex justify-between"},[i("div",[i("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.from))]),i("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.to))])]),i("div",{staticClass:"btnModalForwardReplayContainer"},[i("div",{staticClass:"text-right"},[i("button",{staticClass:"btn-sent text-btn-sent cursor-pointer d-flex align-center",on:{click:t.handleReply}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Send")])])]),i("button",{staticClass:"btn-cancelForwardReply btn-sent cursor-pointer d-flex align-center flex-shrink-0",on:{click:t.handleCancelReply}},[t._v(" Cancel ")])])])],1),i("section",[i("div",{staticClass:"content"},[i("div",{staticClass:"title title-20 f-700 mb-10"},[i("div",{staticClass:"textInput-ForwardAndReply"},[i("div",[t._v("Re:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.titleData,expression:"titleData"}],domProps:{value:t.titleData},on:{input:function(e){e.target.composing||(t.titleData=e.target.value)}}})])]),i("div",{staticClass:"description mb-10"},[i("TipTap",{attrs:{modelValue:t.data,isDetail:!1},on:{updateModelValue:t.updateModelValue}})],1)]),i("div",{staticClass:"mb-16"},[i("div",{staticClass:"f-500 mb-16"},[t._v("Select message type:")]),i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PUBLIC"===t.type},on:{click:function(e){t.type="PUBLIC"}}},[t._v(" Public ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PRIVATE"===t.type},on:{click:function(e){t.type="PRIVATE"}}},[t._v(" Private ")])])]),i("div",[i("div",{staticClass:"f-500"},[t._v("Select NEAR to send:")]),i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.05===t.amount},on:{click:function(e){t.amount=.05}}},[t._v(" 0.05 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])])])])])}),U=[],B=n("b654"),V=n.n(B),W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"logo avatar"},[n("img",{style:[t.windowWidth<768?{height:"40px"}:{height:t.size+" + px"},"width: "+t.size+" + px"],attrs:{src:t.url}})])},H=[],z={props:["accountId","size"],data:function(){return{windowWidth:window.innerWidth,url:n("44c7")}},mounted:function(){this.getAvatarUrl(this.accountId)},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},getAvatarUrl:function(t){var e=this,n=localStorage.getItem("user-avatar-".concat(t));n?this.url=n:I(t,(function(n){n&&(e.url=n,localStorage.setItem("user-avatar-".concat(t),n))}))}}},Y=z,q=Object(T["a"])(Y,W,H,!1,null,"1f667eee",null),J=q.exports,Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.editor?n("div",{staticClass:"editor",style:[t.isDetail?{height:"auto"}:{height:"260px"}]},[n("MenuBarTipTap",{directives:[{name:"show",rawName:"v-show",value:!t.isDetail,expression:"!isDetail"}],staticClass:"editor__header",attrs:{editor:t.editor}}),n("EditorContent",{class:["editor__content",{"modal-expand":t.expandModal}],attrs:{editor:t.editor}})],1):t._e()},X=[],Q=n("1ab4"),tt=n("672a"),et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.items,(function(e,i){return["divider"===e.type?n("div",{key:"divider"+i,staticClass:"divider"}):n("MenuBarItemTipTap",t._b({key:i},"MenuBarItemTipTap",e,!1))]}))],2)},nt=[],it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{class:[{"is-active":t.isActive?t.isActive():null},"null"!==t.icon?"menu-item":"menu-item-text"],attrs:{title:t.title},on:{click:t.action}},["null"!==t.icon?n("svg",{staticClass:"remix"},[n("use",{attrs:{"xlink:href":t.remixiconUrl+"#ri-"+t.icon}})]):n("div",[t._v(t._s(t.title))])])},st=[],at=n("29a1"),ot=n.n(at),rt={props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0},isActive:{type:Function,default:null}},data:function(){return{remixiconUrl:ot.a}}},ct=rt,lt=(n("e53b"),Object(T["a"])(ct,it,st,!1,null,null,null)),ut=lt.exports,dt={components:{MenuBarItemTipTap:ut},props:{editor:{type:Object,required:!0}},data:function(){var t=this;return{items:[{icon:"bold",title:"Bold",action:function(){return t.editor.chain().focus().toggleBold().run()},isActive:function(){return t.editor.isActive("bold")}},{icon:"italic",title:"Italic",action:function(){return t.editor.chain().focus().toggleItalic().run()},isActive:function(){return t.editor.isActive("italic")}},{icon:"strikethrough",title:"Strike",action:function(){return t.editor.chain().focus().toggleStrike().run()},isActive:function(){return t.editor.isActive("strike")}},{icon:"underline",title:"UnderLine",action:function(){return t.editor.chain().focus().toggleUnderline().run()},isActive:function(){return t.editor.isActive("underline")}},{icon:"superscript",title:"Superscript",action:function(){return t.editor.chain().focus().toggleSuperscript().run()},isActive:function(){return t.editor.isActive("superscript")}},{icon:"subscript",title:"Subscript",action:function(){return t.editor.chain().focus().toggleSubscript().run()},isActive:function(){return t.editor.isActive("subscript")}},{icon:"double-quotes-l",title:"Quotes",action:function(){return t.editor.chain().focus().toggleBlockquote().run()},isActive:function(){return t.editor.isActive("blockquote")}},{icon:"separator",title:"Horizontal Rule",action:function(){return t.editor.chain().focus().setHorizontalRule().run()}},{icon:"mark-pen-line",title:"Highlight",action:function(){return t.editor.chain().focus().toggleHighlight().run()},isActive:function(){return t.editor.isActive("highlight")}},{icon:"code-view",title:"Code",action:function(){return t.editor.chain().focus().toggleCode().run()},isActive:function(){return t.editor.isActive("code")}},{icon:"code-box-line",title:"Code Block",action:function(){return t.editor.chain().focus().toggleCodeBlock().run()},isActive:function(){return t.editor.isActive("codeBlock")}},{type:"divider"},{icon:"null",title:"Inter",action:function(){return t.editor.chain().focus().setFontFamily("Inter").run()},isActive:function(){return t.editor.isActive("textStyle",{fontFamily:"Inter"})}},{icon:"null",title:"Comic Sans",action:function(){return t.editor.chain().focus().setFontFamily("Comic Sans MS, Comic Sans").run()},isActive:function(){return t.editor.isActive("textStyle",{fontFamily:"Comic Sans MS, Comic Sans"})}},{icon:"null",title:"Serif",action:function(){return t.editor.chain().focus().setFontFamily("serif").run()},isActive:function(){return t.editor.isActive("textStyle",{fontFamily:"serif"})}},{icon:"null",title:"Monospace",action:function(){return t.editor.chain().focus().setFontFamily("monospace").run()},isActive:function(){return t.editor.isActive("textStyle",{fontFamily:"monospace"})}},{icon:"null",title:"Cursive",action:function(){return t.editor.chain().focus().setFontFamily("cursive").run()},isActive:function(){return t.editor.isActive("textStyle",{fontFamily:"cursive"})}},{icon:"null",title:"Default",action:function(){return t.editor.chain().focus().unsetFontFamily().run()}},{type:"divider"},{icon:"h-1",title:"Heading 1",action:function(){return t.editor.chain().focus().toggleHeading({level:1}).run()},isActive:function(){return t.editor.isActive("heading",{level:1})}},{icon:"h-2",title:"Heading 2",action:function(){return t.editor.chain().focus().toggleHeading({level:2}).run()},isActive:function(){return t.editor.isActive("heading",{level:2})}},{icon:"h-3",title:"Heading 3",action:function(){return t.editor.chain().focus().toggleHeading({level:3}).run()},isActive:function(){return t.editor.isActive("heading",{level:3})}},{icon:"h-4",title:"Heading 4",action:function(){return t.editor.chain().focus().toggleHeading({level:4}).run()},isActive:function(){return t.editor.isActive("heading",{level:4})}},{icon:"h-5",title:"Heading 5",action:function(){return t.editor.chain().focus().toggleHeading({level:5}).run()},isActive:function(){return t.editor.isActive("heading",{level:5})}},{icon:"h-6",title:"Heading 6",action:function(){return t.editor.chain().focus().toggleHeading({level:6}).run()},isActive:function(){return t.editor.isActive("heading",{level:6})}},{icon:"paragraph",title:"Paragraph",action:function(){return t.editor.chain().focus().setParagraph().run()},isActive:function(){return t.editor.isActive("paragraph")}},{icon:"list-unordered",title:"Bullet List",action:function(){return t.editor.chain().focus().toggleBulletList().run()},isActive:function(){return t.editor.isActive("bulletList")}},{icon:"list-ordered",title:"Ordered List",action:function(){return t.editor.chain().focus().toggleOrderedList().run()},isActive:function(){return t.editor.isActive("orderedList")}},{icon:"list-check-2",title:"Task List",action:function(){return t.editor.chain().focus().toggleTaskList().run()},isActive:function(){return t.editor.isActive("taskList")}},{icon:"link",title:"Set Link",action:this.setLink,isActive:function(){return t.editor.isActive("link")}},{icon:"link-unlink",title:"Unset Link",action:function(){return t.editor.chain().focus().unsetLink().run()},isActive:function(){return!t.editor.isActive("link")}},{type:"divider"},{icon:"arrow-go-back-line",title:"Undo",action:function(){return t.editor.chain().focus().undo().run()}},{icon:"arrow-go-forward-line",title:"Redo",action:function(){return t.editor.chain().focus().redo().run()}}]}},methods:{setLink:function(){var t=this.editor.getAttributes("link").href,e=window.prompt("URL",t);null!==e&&(""!==e?this.editor.chain().focus().extendMarkRange("link").setLink({href:e}).run():this.editor.chain().focus().extendMarkRange("link").unsetLink().run())}}},mt=dt,ht=(n("2fdc"),Object(T["a"])(mt,et,nt,!1,null,null,null)),ft=ht.exports,pt=n("9751"),vt=n("0392"),gt=n("79bb"),wt=n("64fe"),bt=n("dce4"),_t=n("cc86"),Mt=n("7206"),Ct=n("2473"),yt=n("3560"),xt=n("58e6"),kt=n("05f2"),It=n("4674"),St={components:{EditorContent:Q["b"],MenuBarTipTap:ft},props:{modelValue:{type:String,default:""},isDetail:{type:Boolean,default:!1}},data:function(){return{editor:null}},computed:{expandModal:function(){return this.$store.state.sendMessageModal.isExpand}},watch:{modelValue:function(t){var e=this.editor.getHTML()===t;e||this.editor.commands.setContent(t,!1)}},mounted:function(){var t=this;this.editor=new Q["a"]({extensions:[tt["a"],pt["a"],vt["a"],gt["a"],bt["a"],wt["a"],_t["a"],Mt["a"],Ct["a"],yt["a"].configure({openOnClick:!0}),xt["a"],kt["a"],It["a"]],content:this.modelValue,onUpdate:function(){t.$emit("updateModelValue",t.editor.getHTML())}}),this.editor.setOptions({editable:!this.isDetail})},beforeDestroy:function(){this.editor.destroy()}},Et=St,Pt=(n("a996"),Object(T["a"])(Et,Z,X,!1,null,"3622f454",null)),At=Pt.exports,Tt={components:{Avatar:J,TipTap:At},props:["id","title","to","from","showReply"],data:function(){return{data:"",titleData:this.title,amount:.05,type:"PUBLIC",senderKey:null}},computed:{username:function(){return window.walletConnection.getAccountId()},privateKeyLocal:function(){return this.$store.state.localPrivateKey}},watch:{type:{immediate:!0,handler:function(){var t=this;"PRIVATE"===this.type&&window.contract.getPublicKey({accountId:this.username}).then((function(e){e&&(t.senderKey=e)}))}}},methods:{updateModelValue:function(t){this.data=t},packMassage:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,console.log("start send",t,w(e.amount)),n.next=4,V.a.packMessage(t);case 4:if(i=n.sent,0===i.code){n.next=7;break}throw new Error("Error when packing messsage"+i);case 7:e.id&&window.localStorage.removeItem("msg-".concat(e.id)),e.amount?window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:e.id,expiredTime:"0"},g,w(e.amount)).then((function(){e.$toast.success("Your message have been sent with"+w(e.amount)+" !",{timeout:2e3})})):window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:e.id,expiredTime:"0"}).then((function(){e.$toast.success("Your message have been sent!",{timeout:2e3})})),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](0),console.error(n.t0),e.$toast.error("Your message can not be send!",{timeout:2e3});case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))()},handleReply:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.titleData.length){e.next=3;break}return t.$toast.error("Please enter the field 'Title'!",{timeout:2e3}),e.abrupt("return");case 3:"PRIVATE"===t.type&&window.contract.getPublicKey({accountId:t.to}).then((function(e){e?(t.privateKeyLocal&&window.contract.getPublicKey({accountId:t.username}).then((function(n){t.packMassage({title:t.title,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:n,receiver:e}})})),t.packMassage({title:t.titleData,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:t.senderKey,receiver:e}})):t.$toast.error("Receiver doesn't have public key!",{timeout:2e3})})),"PUBLIC"===t.type&&t.packMassage({title:t.titleData,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:null,receiver:null}});case 5:case"end":return e.stop()}}),e)})))()},handleCancelReply:function(){this.data="",this.titleData=this.title,this.amount=.05,this.type="PUBLIC",this.$emit("cancelReplay",!this.showReply)}}},Rt=Tt,Nt=(n("209b"),Object(T["a"])(Rt,G,U,!1,null,"93094e38",null)),Ot=Nt.exports,Lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mail-right__sent"},[i("header",{staticClass:"mail-right__item-header d-flex"},[i("Avatar",{attrs:{accountId:t.from,size:"60"}}),i("div",{staticClass:"\n        info\n        pl-30 pl-xl-16 pl-md-16 pl-sm-10\n        flex-grow-1\n        d-flex\n        justify-between\n      "},[i("div",[i("div",{staticClass:"name title-20 mb-10 f-700"},[t._v(t._s(t.from))]),i("div",{staticClass:"to f-500"},[t._v("To: "+t._s(t.to))])]),i("div",{staticClass:"btnModalForwardReplayContainer"},[i("div",{staticClass:"text-right"},[i("button",{staticClass:"btn-sent text-btn-sent cursor-pointer d-flex align-center",on:{click:t.handleForward}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Send")])])]),i("button",{staticClass:"\n            btn-cancelForwardReply btn-sent\n            cursor-pointer\n            d-flex\n            align-center\n            flex-shrink-0\n          ",on:{click:t.handleCancelForward}},[t._v(" Cancel ")])])])],1),i("section",[i("div",{staticClass:"content"},[i("div",{staticClass:"title title-20 f-700 mb-10"},[i("div",{staticClass:"textInput-ForwardAndReply"},[i("div",[t._v("Fw:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.titleData,expression:"titleData"}],domProps:{value:t.titleData},on:{input:function(e){e.target.composing||(t.titleData=e.target.value)}}})])]),i("div",{staticClass:"description mb-10"},[i("TipTap",{attrs:{modelValue:t.data,isDetail:!1},on:{updateModelValue:t.updateModelValue}})],1)]),i("div",{staticClass:"mb-16"},[i("div",{staticClass:"f-500 mb-16"},[t._v("Select message type:")]),i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PUBLIC"===t.type},on:{click:function(e){t.type="PUBLIC"}}},[t._v(" Public ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PRIVATE"===t.type},on:{click:function(e){t.type="PRIVATE"}}},[t._v(" Private ")])])]),i("div",[i("div",{staticClass:"f-500"},[t._v("Select NEAR to send:")]),i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.05===t.amount},on:{click:function(e){t.amount=.05}}},[t._v(" 0.05 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])])])])])},$t=[],Kt={components:{Avatar:J,TipTap:At},props:["id","title","to","from","showForward"],data:function(){return{data:"",titleData:this.title,amount:.05,type:"PUBLIC",senderKey:null}},computed:{username:function(){return window.walletConnection.getAccountId()},privateKeyLocal:function(){return this.$store.state.localPrivateKey}},watch:{type:{immediate:!0,handler:function(){var t=this;"PRIVATE"===this.type&&window.contract.getPublicKey({accountId:this.username}).then((function(e){e&&(t.senderKey=e)}))}}},methods:{updateModelValue:function(t){this.data=t},packMassage:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,console.log("start send",t,w(e.amount)),n.next=4,V.a.packMessage(t);case 4:if(i=n.sent,0===i.code){n.next=7;break}throw new Error("Error when packing messsage"+i);case 7:e.amount?window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:e.id,expiredTime:"0"},g,w(e.amount)).then((function(){e.$toast.success("Your message have been sent with"+w(e.amount)+" !",{timeout:2e3})})):window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"}).then((function(){e.$toast.success("Your message have been sent!",{timeout:2e3})})),n.next=14;break;case 10:n.prev=10,n.t0=n["catch"](0),console.error(n.t0),e.$toast.error("Your message can not be send!",{timeout:2e3});case 14:case"end":return n.stop()}}),n,null,[[0,10]])})))()},handleForward:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.titleData.length){e.next=3;break}return t.$toast.error("Please enter the field 'Title'!",{timeout:2e3}),e.abrupt("return");case 3:"PRIVATE"===t.type&&window.contract.getPublicKey({accountId:t.to}).then((function(e){e?(t.privateKeyLocal&&window.contract.getPublicKey({accountId:t.username}).then((function(n){t.packMassage({title:t.title,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:n,receiver:e}})})),t.packMassage({title:t.titleData,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:t.senderKey,receiver:e}})):t.$toast.error("Receiver doesn't have public key!",{timeout:2e3})})),"PUBLIC"===t.type&&t.packMassage({title:t.titleData,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:null,receiver:null}});case 5:case"end":return e.stop()}}),e)})))()},handleCancelForward:function(){this.data="",this.titleData=this.title,this.amount=.05,this.type="PUBLIC",this.$emit("cancelForward",!this.showForward)}}},jt=Kt,Ft=(n("ed78"),Object(T["a"])(jt,Lt,$t,!1,null,"839e0508",null)),Dt=Ft.exports,Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade",appear:""}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"container"},[t._t("default")],2)])},Ut=[],Bt={props:["isShow"]},Vt=Bt,Wt=(n("9253"),Object(T["a"])(Vt,Gt,Ut,!1,null,"7e828483",null)),Ht=Wt.exports,zt=n("5a0c"),Yt=n.n(zt),qt={props:["dataMsg","from"],components:{ReplyMessage:Ot,ForwardMessage:Dt,Avatar:J,TipTap:At,Tooltip:Ht},data:function(){return{showDetail:this.dataMsg.id===this.$store.state.messageConversation.msgInboxId,showReply:!1,showForward:!1,showTooltip:!1,percent:.1}},computed:{realTime:function(){return this.$store.state.realTime}},watch:{realTime:{immediate:!0,handler:function(){this.handleSetPercent(this.dataMsg.timestamp)}}},methods:{handleShowReply:function(){this.showForward||(this.showReply=!this.showReply)},handleShowForward:function(){this.showReply||(this.showForward=!this.showForward)},cancelReplay:function(t){this.showReply=t},cancelForward:function(t){this.showForward=t},handleSetPercent:function(t){if(t&&this.realTime){var e=Yt()(this.realTime).diff(Yt()(t),"hour");e>1&&e<24&&(this.percent=.5),e<1&&e<24&&(this.percent=1)}},handleCalculateReceivedAmount:function(){var t=_(this.dataMsg.moneyInfo.canReceivedAmount);return(Number(t)*this.percent).toFixed(4)},handleCheck:function(){var t=_(this.dataMsg.moneyInfo.receivedAmount),e=_(this.dataMsg.moneyInfo.sendBackAmount);return 0==t&&0==e}}},Jt=qt,Zt=(n("82d7"),Object(T["a"])(Jt,F,D,!1,null,"70aadbb2",null)),Xt=Zt.exports,Qt={components:{MessageDetail:Xt},data:function(){return{windowWidth:window.innerWidth,dataMsgConversation:[]}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},computed:{userLogin:function(){return this.$store.state.auth.auth.isLogin},msgInboxId:function(){return this.$store.state.messageConversation.msgInboxId},routePathSent:function(){return"/sent"===this.$route.path},localPrivateKey:function(){return this.$store.state.localPrivateKey},passwordConfirm:function(){return this.$store.state.passwordConfirm}},watch:{msgInboxId:function(){this.dataMsgConversation=[],this.getMessages(this.msgInboxId)},localPrivateKey:function(){this.dataMsgConversation=[],this.getMessages(this.msgInboxId)},routePathSent:function(){this.dataMsgConversation=[],this.getMessages(this.msgInboxId)},passwordConfirm:function(){this.dataMsgConversation=[]}},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},getMessages:function(t){var e=this;if(null!==t){var n=null;this.passwordConfirm&&this.localPrivateKey&&(n=Object(B["decryptPrivateKeyWithPasswordConfirm"])(this.passwordConfirm,this.localPrivateKey));var i={isLoadFromIpfs:V.a.clientConfig.isSupportIpfs,isInboxMsg:!this.routePathSent,privateKey:null!==n?n.slice(5):null},s=window.localStorage.getItem("msg-".concat(t));s?this.updateDataMessage(JSON.parse(s),i):window.contract.getMessage({msgId:t}).then((function(n){window.localStorage.setItem("msg-".concat(t),JSON.stringify(n)),e.updateDataMessage(n,i)}))}},updateDataMessage:function(t,e){var n=this;return Object(m["a"])(regeneratorRuntime.mark((function i(){var s,a,o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s={baseSite:t.baseSite,data:t.data,expiredTime:t.expiredTime,from:t.from,id:t.id,prevMsgId:t.prevMsgId,timestamp:t.timestamp,title:t.title,to:t.to,moneyInfo:t.moneyInfo,isPrivate:t.data.includes("DIRECT-PRI")},i.next=3,V.a.depackMessage(s,e);case 3:a=i.sent,0===a.prevMsgId?(n.dataMsgConversation.push(a),n.dataMsgConversation.reverse()):(n.getMessages(a.prevMsgId),o=Object(j["a"])(n.dataMsgConversation),o.push(a),n.dataMsgConversation=o);case 5:case"end":return i.stop()}}),i)})))()}}},te=Qt,ee=Object(T["a"])(te,$,K,!1,null,"eeee0cf8",null),ne=ee.exports,ie={components:{AllMessages:ne},data:function(){return{windowWidth:window.innerWidth}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},computed:{userLogin:function(){return this.$store.state.auth.auth.isLogin},msgInboxId:function(){return this.$store.state.messageConversation.msgInboxId},routePathInbox:function(){return"/inbox"===this.$route.path||"/"===this.$route.path},routePathSent:function(){return"/sent"===this.$route.path},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},totalMsg:function(){return this.routePathInbox?this.inboxMsgNum:this.sentMsgNum},page:function(){return this.$store.state.page},reachMaxPage:function(){return 20*this.page>this.totalMsg},preventPagination:function(){return this.$store.state.preventPagination}},watch:{$route:function(t,e){t.name!==e.name&&this.$store.commit("SET_PAGE",1)}},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},nextPage:function(){this.$store.commit("SET_PAGE",this.page+1)},prevPage:function(){this.$store.commit("SET_PAGE",this.page-1)}}},se=ie,ae=Object(T["a"])(se,O,L,!1,null,"8e0ec2de",null),oe=ae.exports,re=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("footer",{staticClass:"footer-mobile flex-sm is-hidden"},[i("button",{staticClass:"btn-toggle-menu",on:{click:t.handleActiveMobileMenu}},[i("img",{attrs:{src:n("0773")}})]),i("div",{staticClass:"mail-left__menu d-flex align-center pl-20"},[i("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[i("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-between",class:{active:t.routePathInbox},attrs:{to:"/inbox"}},[i("span",{staticClass:"d-flex align-center"},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("40e0")}}),i("span",{staticClass:"ml-10 title"},[t._v("Inbox")])]),i("span",{staticClass:"letter-spacing-5 pl-10"},[t._v(t._s(t.inboxMsgNum))])])],1),i("div",{on:{click:function(e){return t.handleResetSelectedMailId()}}},[i("router-link",{staticClass:"mail-left__menu-item d-flex align-center justify-center ml-4",class:{active:t.routePathSent},attrs:{to:"/sent"}},[i("span",{staticClass:"d-flex align-center"},[i("img",{staticClass:"flex-shrink-0",attrs:{src:n("8f55")}}),i("span",{staticClass:"ml-10 title"},[t._v("Sent")])]),i("span",{staticClass:"letter-spacing-5 pl-10"},[t._v(t._s(t.sentMsgNum))])])],1)]),i("div",{staticClass:"mail-content__button"},[i("div",[i("span",{directives:[{name:"show",rawName:"v-show",value:t.page>1,expression:"page > 1"}],staticClass:"mail-content__button-prev cursor-pointer mr-4 mr-sm-16",on:{click:function(e){return t.prevPage()}}}),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.reachMaxPage&&!t.preventPagination,expression:"!reachMaxPage && !preventPagination"}],staticClass:"mail-content__button-next cursor-pointer",on:{click:function(e){return t.nextPage()}}})])]),i("button",{staticClass:"btn-mail btn-mail__sent btn-compose__footer cursor-pointer",on:{click:t.handleSendMessageModal}},[t._m(0)])])},ce=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"btn-mail__wrap d-flex align-center justify-center"},[i("img",{staticClass:"logo-dark flex-shrink-0",attrs:{src:n("6e81")}}),i("img",{staticClass:"logo-light flex-shrink-0",attrs:{src:n("619a")}}),i("span",{staticClass:"title-16 f-700 letter-spacing-5 color-white ml-20 ml-sm-10"},[t._v(" COMPOSE")])])}],le={data:function(){return{isRoute:!1}},mounted:function(){},computed:{username:function(){return window.walletConnection.getAccountId()},sentMsgNum:function(){return this.$store.state.sentMsgNum},inboxMsgNum:function(){return this.$store.state.inboxMsgNum},routePathSent:function(){return"/sent"===this.$route.path},routePathInbox:function(){return"/inbox"===this.$route.path||"/"===this.$route.path},totalMsg:function(){return this.routePathInbox?this.inboxMsgNum:this.sentMsgNum},page:function(){return this.$store.state.page},reachMaxPage:function(){return 20*this.page>this.totalMsg},preventPagination:function(){return this.$store.state.preventPagination}},watch:{$route:function(t,e){t.name!==e.name&&this.$store.commit("SET_PAGE",1)}},methods:{handleActiveMobileMenu:function(){this.$store.commit("TOGGLE_ACTIVE_MOBILE_MENU"),this.$store.state.sendMessageModal.isShow&&this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleResetSelectedMailId:function(){this.$store.commit("RESET_MESSAGE_CONVERSATION",null)},nextPage:function(){this.$store.commit("SET_PAGE",this.page+1)},prevPage:function(){this.$store.commit("SET_PAGE",this.page-1)}}},ue=le,de=Object(T["a"])(ue,re,ce,!1,null,"d0c6e11e",null),me=de.exports,he=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["modal-sent",{"is-hidden":!t.showModal},{"modal-expand":t.expandModal},{"modal-minimize":t.minimizeModal}]},[i("header",{staticClass:"\n      modal-sent__header\n      d-flex\n      align-center\n      justify-between\n      mb-30 mb-sm-0\n    "},[t._m(0),i("div",{staticClass:"action hidden-sm"},[i("span",{staticClass:"btn-minimize cursor-pointer",class:{"mr-20":t.windowWidth<=1024},on:{click:t.handleMinimizeSendMessageModal}},[i("svg",{attrs:{width:"20",height:"4",viewBox:"0 0 20 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("line",{attrs:{x1:"1.5",y1:"1.64258",x2:"18.5",y2:"1.64258",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])]),i("span",{staticClass:"btn-expand cursor-pointer ml-20 mr-20",class:{"d-none":t.windowWidth<=1024},on:{click:t.handleExpandSendMessageModal}},[i("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M0 14.1426L5.57678 12.6483L1.49429 8.5658L0 14.1426ZM14.1421 0.000442743L8.56536 1.49473L12.6478 5.57722L14.1421 0.000442743ZM3.53553 11.3142L11.3137 3.53598L10.6066 2.82887L2.82843 10.607L3.53553 11.3142Z",fill:"#888A90"}})])]),i("span",{staticClass:"btn-close cursor-pointer",on:{click:t.handleCloseSendMessageModal}},[i("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2.14209 16.1426L16.2842 2.00044",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}}),i("path",{attrs:{d:"M2.14209 2L16.2842 16.1421",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])])])]),i("div",{staticClass:"f-8 is-hidden block-sm mb-20"},[t._v(" Message conversation history. ")]),i("section",{staticClass:"modal-sent__body"},[i("div",{staticClass:"form-input d-flex pb-10 mb-20"},[i("span",{class:[{isEmptyText:t.checkToInput}]},[t._v("To: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.to,expression:"to"}],attrs:{placeholder:"Enter the NEAR account here"},domProps:{value:t.to},on:{input:function(e){e.target.composing||(t.to=e.target.value)}}}),i("div",{staticClass:"line",class:[{isEmpty:t.checkToInput}]})]),i("div",{staticClass:"form-input d-flex pb-10 mb-20"},[i("span",{class:[{isEmptyText:t.checkTitleInput}]},[t._v("Subject: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{placeholder:"Enter the subject here"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),i("div",{staticClass:"line",class:[{isEmpty:t.checkTitleInput}]})]),i("div",{staticClass:"mb-20"},[i("TipTap",{attrs:{modelValue:t.data,isDetail:!1},on:{updateModelValue:t.updateModelValue}})],1),i("div",{staticClass:"mb-16"},[i("div",{staticClass:"f-500 mb-16"},[t._v("Select message type:")]),i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PUBLIC"===t.type},on:{click:function(e){t.type="PUBLIC"}}},[t._v(" Public ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:"PRIVATE"===t.type},on:{click:function(e){t.type="PRIVATE"}}},[t._v(" Private ")])])]),i("div",{staticClass:"f-500 mb-16"},[t._v("Select NEAR to send:")]),i("div",{staticClass:"d-flex align-center justify-between"},[i("div",{staticClass:"near__value-list d-flex"},[i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.05===t.amount},on:{click:function(e){t.amount=.05}}},[t._v(" 0.05 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.1===t.amount},on:{click:function(e){t.amount=.1}}},[t._v(" 0.1 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:.2===t.amount},on:{click:function(e){t.amount=.2}}},[t._v(" 0.2 NEAR ")]),i("div",{staticClass:"near__value-item cursor-pointer",class:{active:1===t.amount},on:{click:function(e){t.amount=1}}},[t._v(" 1 NEAR ")])]),i("div",{staticClass:"btnModalContainer"},[i("button",{staticClass:"\n            btn-sent\n            text-btn-sent\n            cursor-pointer\n            d-flex\n            align-center\n            flex-shrink-0\n          ",on:{click:t.handleSendMessageModal}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Send")])]),i("button",{staticClass:"\n            btn-sent btn-cancel\n            cursor-pointer\n            d-flex\n            align-center\n            flex-shrink-0\n          ",on:{click:t.handleCloseSendMessageModal}},[t._v(" Cancel ")])])])])])},fe=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"title title-20 f-700 d-flex align-center"},[i("img",{staticClass:"is-hidden block-sm mr-10",staticStyle:{width:"29px"},attrs:{src:n("5f2b")}}),t._v(" New message ")])}],pe={components:{TipTap:At},data:function(){return{to:"",title:"",data:"",amount:.05,type:"PUBLIC",windowWidth:window.innerWidth,checkToInput:!1,checkTitleInput:!1,senderKey:null}},created:function(){window.addEventListener("resize",this.myEventHandler)},destroyed:function(){window.removeEventListener("resize",this.myEventHandler)},computed:{showModal:function(){return this.$store.state.sendMessageModal.isShow},expandModal:function(){return this.$store.state.sendMessageModal.isExpand},minimizeModal:function(){return this.$store.state.sendMessageModal.isMinimize},username:function(){return window.walletConnection.getAccountId()},privateKeyLocal:function(){return this.$store.state.localPrivateKey}},watch:{type:{immediate:!0,handler:function(){var t=this;"PRIVATE"===this.type&&window.contract.getPublicKey({accountId:this.username}).then((function(e){e&&(t.senderKey=e)}))}}},methods:{myEventHandler:function(){this.windowWidth=window.innerWidth},updateModelValue:function(t){this.data=t},packMassage:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,console.log("start send",t,w(e.amount)),n.next=4,V.a.packMessage(t);case 4:if(i=n.sent,0===i.code){n.next=7;break}throw new Error("Error when packing messsage"+i);case 7:e.amount?window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"},g,w(e.amount)).then((function(){e.$toast.success("Your message have been sent with"+w(e.amount)+" !",{timeout:2e3})})):window.contract.sendMessage({to:e.to,title:i.title,data:i.data,baseSite:window.location.origin,prevMsgId:0,expiredTime:"0"}).then((function(){e.$toast.success("Your message have been sent!",{timeout:2e3})})),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),console.error(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()},handleSendMessageModal:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.to.length||t.title.length){e.next=7;break}return t.$toast.error("Please enter the field 'To' and 'Subject'!",{timeout:2e3}),t.checkTitleInput=!0,t.checkToInput=!0,e.abrupt("return");case 7:t.checkTitleInput=!1,t.checkToInput=!1;case 9:if(t.to.length){e.next=15;break}return t.$toast.error("Please enter the field 'To'!",{timeout:2e3}),t.checkToInput=!0,e.abrupt("return");case 15:t.checkToInput=!1;case 16:if(t.title.length){e.next=22;break}return t.$toast.error("Please enter the field 'Subject'!",{timeout:2e3}),t.checkTitleInput=!0,e.abrupt("return");case 22:t.checkTitleInput=!1;case 23:return e.next=25,S(t.to);case 25:if(e.sent){e.next=32;break}return t.checkToInput=!1,t.checkTitleInput=!1,t.$store.commit("TOGGLE_ALERT_MODAL",t.to),e.abrupt("return");case 32:"PRIVATE"===t.type&&window.contract.getPublicKey({accountId:t.to}).then((function(e){e?(t.privateKeyLocal&&window.contract.getPublicKey({accountId:t.username}).then((function(n){t.packMassage({title:t.title,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:n,receiver:e}})})),t.packMassage({title:t.title,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:t.senderKey,receiver:e}})):t.$toast.error("Receiver doesn't have public key!",{timeout:2e3})})),"PUBLIC"===t.type&&t.packMassage({title:t.title,content:t.data,attachmentFiles:{},type:t.type,keys:{sender:null,receiver:null}});case 34:case"end":return e.stop()}}),e)})))()},handleCloseSendMessageModal:function(){this.checkToInput=!1,this.checkTitleInput=!1,this.to="",this.title="",this.data="",this.amount=.05,this.type="PUBLIC",this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},handleExpandSendMessageModal:function(){this.windowWidth<=1024||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL_EXPAND")},handleMinimizeSendMessageModal:function(){this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL_MINIMIZE")}}},ve=pe,ge=(n("41e0"),Object(T["a"])(ve,he,fe,!1,null,"302748f0",null)),we=ge.exports,be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide",appear:""}},[t.showModal?n("div",{staticClass:"modal"},[n("h2",[t._v("Whoa! Take it easy")]),n("div",{staticClass:"content"},[t._v(" The account "),n("span",[t._v(t._s(t.nameTo))]),t._v(" is not existed. "),n("div",[t._v("Please enter the other account!")])]),n("button",{staticClass:"\n        btn-sent btn-confirm-sent\n        cursor-pointer\n        d-flex\n        align-center\n        flex-shrink-0\n      ",on:{click:t.handleCloseModal}},[n("span",[t._v("Got it!")])])]):t._e()])},_e=[],Me={computed:{showModal:function(){return this.$store.state.alertModal.isShow},nameTo:function(){return this.$store.state.alertModal.name}},methods:{handleCloseModal:function(){this.$store.commit("TOGGLE_ALERT_MODAL","")}}},Ce=Me,ye=(n("9dc9"),Object(T["a"])(Ce,be,_e,!1,null,"f02efeba",null)),xe=ye.exports,ke=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("transition",{attrs:{name:"slide",appear:""}},[t.showModal?i("div",{staticClass:"modal"},[i("div",{staticClass:"header d-flex align-center justify-between mb-20"},[i("div",{staticClass:"title title-20 f-700 d-flex align-center"},[t._v(" Key Management ")]),i("div",{staticClass:"action"},[i("span",{staticClass:"btn-close cursor-pointer",on:{click:t.handleCloseModal}},[i("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2.14209 16.1426L16.2842 2.00044",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}}),i("path",{attrs:{d:"M2.14209 2L16.2842 16.1421",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])])])]),i("div",{staticClass:"container"},[i("div",{staticClass:"form-input d-flex pb-10 mb-20"},[i("span",[t._v("Public Key: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.hiddenPubKey,expression:"hiddenPubKey"}],attrs:{placeholder:"*****",disabled:""},domProps:{value:t.hiddenPubKey},on:{input:function(e){e.target.composing||(t.hiddenPubKey=e.target.value)}}}),i("div",{staticClass:"line"})]),i("div",{staticClass:"form-input d-flex pb-10 mb-20"},[i("span",[t._v("Private Key: ")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.hiddenPriKey,expression:"hiddenPriKey"}],attrs:{placeholder:"*****",disabled:""},domProps:{value:t.hiddenPriKey},on:{input:function(e){e.target.composing||(t.hiddenPriKey=e.target.value)}}}),i("div",{staticClass:"line"})]),i("div",{staticClass:"d-flex flex-col-sm",staticStyle:{gap:"1rem"}},[i("button",{staticClass:"\n              btn-sent btn-sent-key\n              cursor-pointer\n              d-flex\n              align-center\n              justify-center\n              flex-shrink-0\n            ",on:{click:t.genKeyClick}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Generate")])]),i("label",{staticClass:"\n              btn-sent btn-sent-key\n              cursor-pointer\n              d-flex\n              align-center\n              justify-center\n              flex-shrink-0\n            "},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Import")]),i("input",{ref:"doc",attrs:{type:"file"},on:{change:function(e){return t.importKeyClick()}}})]),i("button",{staticClass:"\n              btn-sent btn-sent-key\n              cursor-pointer\n              d-flex\n              align-center\n              justify-center\n              flex-shrink-0\n            ",on:{click:t.exportKeys}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Export")])])])])]):t._e()]),i("ConfirmModal",{attrs:{showModal:t.showModalConfirmReGenImport,handleConfirmFn:t.handleConfirm},on:{closeConfirmModal:function(e){return t.closeConfirmModal(e)}}},[i("div",{style:{fontSize:"15px"}},[t._v(" Are you sure to override the old key? "),i("br"),t._v(" Override new key will make existed privated messages unable to decrypt ")])]),i("ConfirmPasswordModal",{attrs:{showModalConfirm:t.showModalPassword,onPasswordConfirm:t.handlePasswordConfirm},on:{toggleConfirmPasswordModal:function(e){return t.toggleConfirmPasswordModal(e)}}})],1)},Ie=[],Se=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide",appear:""}},[t.showModal?i("div",{staticClass:"modal"},[i("div",{staticClass:"header d-flex align-center justify-between mb-20"},[i("div",{staticClass:"title title-20 f-700 d-flex align-center"},[t._v("Confirmation")]),i("div",{staticClass:"action"},[i("span",{staticClass:"btn-close cursor-pointer",on:{click:t.handleCloseModal}},[i("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2.14209 16.1426L16.2842 2.00044",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}}),i("path",{attrs:{d:"M2.14209 2L16.2842 16.1421",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])])])]),i("div",{staticClass:"container"},[t._t("default"),i("div",{staticClass:"container-btn"},[i("button",{staticClass:"\n            btn-sent btn-sent-key\n            cursor-pointer\n            d-flex\n            align-center\n            justify-center\n            flex-shrink-0\n          ",on:{click:t.handleConfirm}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Confirm")])]),i("button",{staticClass:"\n            btn-sent btn-sent-key\n            cursor-pointer\n            d-flex\n            align-center\n            justify-center\n            flex-shrink-0\n          ",on:{click:t.handleCloseModal}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Cancel")])])])],2)]):t._e()])}),Ee=[],Pe={props:{showModal:{type:Boolean},handleConfirmFn:{type:Function}},methods:{handleCloseModal:function(){this.$emit("closeConfirmModal",!1)},handleConfirm:function(){this.$emit("closeConfirmModal",!1),this.handleConfirmFn()}}},Ae=Pe,Te=(n("8af7"),Object(T["a"])(Ae,Se,Ee,!1,null,"6a851c4a",null)),Re=Te.exports,Ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"slide",appear:""}},[t.showModalConfirm?i("div",{staticClass:"modal"},[i("div",{staticClass:"header d-flex align-center justify-between mb-20"},[i("div",{staticClass:"title title-20 f-700 d-flex align-center"},[t._v(" Enter password for private message ")]),i("div",{staticClass:"action"},[i("span",{staticClass:"btn-close cursor-pointer",on:{click:t.handleCloseModal}},[i("svg",{attrs:{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M2.14209 16.1426L16.2842 2.00044",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}}),i("path",{attrs:{d:"M2.14209 2L16.2842 16.1421",stroke:"#888A90","stroke-width":"3","stroke-linecap":"round"}})])])])]),i("div",{staticClass:"container"},[i("div",{staticClass:"form-input d-flex pb-10 mb-20"},[i("span",{class:[{isEmptyText:t.checkPasswordInput}]},[t._v("Password:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{placeholder:"Enter your password",type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),i("div",{staticClass:"line",class:[{isEmpty:t.checkPasswordInput}]})]),i("button",{staticClass:"\n          btn-sent btn-sent-key\n          cursor-pointer\n          d-flex\n          align-center\n          justify-center\n          flex-shrink-0\n        ",on:{click:t.handleConfirm}},[i("img",{attrs:{src:n("8f55")}}),i("span",[t._v("Confirm")])])])]):t._e()])},Oe=[],Le={props:{showModalConfirm:{type:Boolean},onPasswordConfirm:{type:Function}},data:function(){return{password:"",checkPasswordInput:!1}},methods:{handleCloseModal:function(){this.$emit("toggleConfirmPasswordModal",!1),this.password=""},handleConfirm:function(){""===this.password?this.checkPasswordInput=!0:(this.checkPasswordInput=!1,this.onPasswordConfirm&&this.onPasswordConfirm(this.password),this.handleCloseModal())}}},$e=Le,Ke=(n("84d3"),Object(T["a"])($e,Ne,Oe,!1,null,"04f911c4",null)),je=Ke.exports,Fe={components:{ConfirmModal:Re,ConfirmPasswordModal:je},data:function(){return{publicKey:null,privateKey:null,file:null,showModalConfirmReGenImport:!1,showModalPassword:!1,handleConfirm:function(){},handlePasswordConfirm:function(){}}},computed:{showModal:function(){return this.$store.state.keyModal},passwordConfirm:function(){return this.$store.state.passwordConfirm},username:function(){return window.walletConnection.getAccountId()},hiddenPubKey:function(){return this.publicKey?this.publicKey.slice(0,10)+"********************"+this.publicKey.substr(-10):""},hiddenPriKey:function(){return this.privateKey?this.privateKey.slice(0,10)+"********************"+this.privateKey.substr(-10):""}},mounted:function(){localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"))&&(this.privateKey=localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"))),localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_publickey"))&&(this.publicKey=localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_publickey")))},methods:{handleCloseModal:function(){this.$store.commit("TOGGLE_KEY_MODAL")},closeConfirmModal:function(t){this.showModalConfirmReGenImport=t},updateKeysApi:function(t){var e=this;window.contract.updatePublicKey({publicKey:t}).then((function(t){t?e.$toast.success("Success update key!",{timeout:2e3}):e.$toast.error("Error update key!",{timeout:2e3})}))},toggleConfirmPasswordModal:function(t){this.showModalPassword=t},confirmOverride:function(t){var e=localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_publickey")),n=localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"));e&&n?(this.showModalConfirmReGenImport=!0,this.handleConfirm=t):t()},genKeyClick:function(){this.confirmOverride(this.genKeys)},genKeys:function(){var t=this,e=Object(B["generateRSAKey"])();this.showModalPassword=!0,this.handlePasswordConfirm=function(n){t.handlePublicKeyGen(e.publicKey),t.handlePrivateKey(Object(B["encryptPrivateKeyWithPasswordConfirm"])(n,e.privateKey)),t.$store.commit("PASSWORD_CONFIRM",n)}},importKeyClick:function(){this.confirmOverride(this.importKeys)},importKeys:function(){var t=this;this.file=this.$refs.doc.files[0];var e=new FileReader;this.file.name.includes(".pem")?(e.onload=function(e){var n=e.target.result;t.showModalPassword=!0,t.handlePasswordConfirm=function(e){t.handlePublicKeyImport(n),t.handlePrivateKey(Object(B["encryptPrivateKeyWithPasswordConfirm"])(e,n)),t.$store.commit("PASSWORD_CONFIRM",e)}},e.onerror=function(t){return console.log(t)},e.readAsText(this.file)):(this.$toast.error("Invalid Private Key!",{timeout:2e3}),e.onerror=function(t){return console.log(t)},e.readAsText(this.file))},exportKeys:function(){var t=this;localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"))&&(this.showModalPassword=!0,this.handlePasswordConfirm=function(e){var n=Object(B["decryptPrivateKeyWithPasswordConfirm"])(e,localStorage.getItem("".concat("app.nearmessage.testnet","_").concat(t.username,"_privatekey")));n.includes("TEST")?t.handleExportKeys(n):t.$toast.error("Your Confirmation Password is incorrect.")})},handleExportKeys:function(t){if(t){var e=new Blob([t.slice(5)],{type:"text/plain"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,"PrivateKeys.pem");else{var n=document.createElement("a"),i=URL.createObjectURL(e);n.href=i,n.download="PrivateKeys.pem",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)}),0)}this.$toast.success("Success Export Private Key!",{timeout:2e3})}else this.$toast.warning("Please Generate or Import Key!",{timeout:2e3})},handlePublicKeyImport:function(t){var e=Object(B["privateKeyToPublicKey"])(t);this.handlePublicKeyGen(e)},handlePublicKeyGen:function(t){localStorage.setItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_publickey"),t),this.publicKey=t,this.updateKeysApi(t)},handlePrivateKey:function(t){localStorage.setItem("".concat("app.nearmessage.testnet","_").concat(this.username,"_privatekey"),t),this.$store.commit("TOGGLE_PRIVATEKEY_LOCAL",{key:t,userName:this.username}),this.privateKey=t}}},De=Fe,Ge=(n("6e1a"),Object(T["a"])(De,ke,Ie,!1,null,"238f9d62",null)),Ue=Ge.exports,Be=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade",appear:""}},[t.alertModal||t.keyModal?n("div",{staticClass:"modalOverlay"}):t._e()])},Ve=[],We={computed:{alertModal:function(){return this.$store.state.alertModal.isShow},keyModal:function(){return this.$store.state.keyModal}}},He=We,ze=(n("53c1"),Object(T["a"])(He,Be,Ve,!1,null,"1d49acbe",null)),Ye=ze.exports,qe={components:{Sidebar:N,MailContent:oe,FooterMobile:me,SentMessageModal:we,AlertModal:xe,KeyManagementModal:Ue,Overlay:Ye}},Je=qe,Ze=(n("b385"),Object(T["a"])(Je,c,l,!1,null,"56ae731e",null)),Xe=Ze.exports,Qe=r()("production");console.log("networkId:".concat(Qe.networkId," CONTRACT_NAME:").concat(Qe.contractName)),window.networkId=Qe.networkId;var tn={created:function(){document.title="NEAR Messaging Service"},name:"App",components:{Convert:Xe,ConfirmPasswordModal:je},data:function(){return{showModalPassword:!1,onPasswordConfirm:function(){}}},computed:{isSignedIn:function(){return window.walletConnection.isSignedIn()},darkMode:function(){return this.$store.state.darkMode},showAlertModal:function(){return this.$store.state.alertModal.isShow},showKeyModal:function(){return this.$store.state.keyModal},showConfirmPasswordModal:function(){return this.$store.state.confirmPasswordModal},localPrivateKey:function(){return this.$store.state.localPrivateKey}},methods:{toggleConfirmPasswordModal:function(t){this.showModalPassword=t},handleOverflow:function(t){document.querySelector("body").style.overflow=t?"hidden":"visible"},handleCheckTime:function(){var t=new Date;this.$store.commit("SAVE_REAL_TIME",t)},checkTime:function(){var t=this;window.setInterval((function(){t.handleCheckTime()}),1e3)}},watch:{darkMode:{immediate:!0,handler:function(){this.darkMode?document.querySelector("html").setAttribute("data-theme","light"):document.querySelector("html").setAttribute("data-theme","dark")}},showAlertModal:{immediate:!0,handler:function(){this.handleOverflow(this.showAlertModal)}},showKeyModal:{immediate:!0,handler:function(){this.handleOverflow(this.showKeyModal)}},showConfirmPasswordModal:{immediate:!0,handler:function(){this.handleOverflow(this.showConfirmPasswordModal)}},isSignedIn:{immediate:!0,handler:function(){this.$store.commit("SET_AUTH",this.isSignedIn)}}},mounted:function(){var t=this;null!==this.localPrivateKey&&this.$store.state.auth.auth.isLogin&&(this.$toast.warning("Please confirm password to read private message",{timeout:3e3}),this.showModalPassword=!0,this.onPasswordConfirm=function(e){var n=Object(B["decryptPrivateKeyWithPasswordConfirm"])(e,t.localPrivateKey);n.includes("TEST")?(t.$store.commit("PASSWORD_CONFIRM",e),t.$toast.success("Password is correct")):t.$toast.error("Your Confirmation Password is incorrect. Refresh to retry")}),null===this.localPrivateKey&&this.$store.state.auth.auth.isLogin&&this.$toast.warning("Please generate or import key to use this app",{timeout:3e3}),this.checkTime()}},en=tn,nn=Object(T["a"])(en,s,a,!1,null,null,null),sn=nn.exports,an=n("8c4f"),on=n("2f62"),rn={auth:{isLogin:!!window.walletConnection&&window.walletConnection.isSignedIn()}},cn={},ln={},un={SET_AUTH:function(t,e){t.auth.isLogin=e}},dn={state:rn,getters:cn,actions:ln,mutations:un};i["a"].use(on["a"]);var mn={modules:{auth:dn},state:{darkMode:JSON.parse(localStorage.getItem("darkMode")),activeMobileMenu:!1,sendMessageModal:{isShow:!1,isExpand:!1,isMinimize:!1},alertModal:{isShow:!1,name:""},keyModal:!1,localPrivateKey:null,passwordConfirm:null,messageConversation:{msgInboxId:null},inboxMsgNum:0,sentMsgNum:0,page:1,preventPagination:!1,inboxSearchKeyword:"",sentSearchKeyword:"",realTime:null},mutations:{SAVE_REAL_TIME:function(t,e){t.realTime=e},TOGGLE_DARK_MODE:function(t){t.darkMode=!t.darkMode,localStorage.setItem("darkMode",JSON.stringify(t.darkMode))},TOGGLE_ACTIVE_MOBILE_MENU:function(t){t.activeMobileMenu=!t.activeMobileMenu},TOGGLE_SEND_MESSAGE_MODAL:function(t){t.sendMessageModal.isShow=!t.sendMessageModal.isShow},TOGGLE_SEND_MESSAGE_MODAL_EXPAND:function(t){t.sendMessageModal.isExpand=!t.sendMessageModal.isExpand},TOGGLE_SEND_MESSAGE_MODAL_MINIMIZE:function(t){t.sendMessageModal.isMinimize=!t.sendMessageModal.isMinimize},TOGGLE_ALERT_MODAL:function(t,e){t.alertModal.isShow=!t.alertModal.isShow,t.alertModal.name=e},TOGGLE_KEY_MODAL:function(t){t.keyModal=!t.keyModal},PASSWORD_CONFIRM:function(t,e){t.passwordConfirm=e},TOGGLE_PRIVATEKEY_LOCAL:function(t,e){var n=e.key,i=e.userName;t.localPrivateKey=n,localStorage.setItem("".concat("app.nearmessage.testnet","_").concat(i,"_privatekey"),n)},MESSAGE_CONVERSATION:function(t,e){t.messageConversation.msgInboxId=e},RESET_MESSAGE_CONVERSATION:function(t,e){t.messageConversation.msgInboxId=e},SET_INBOX_MSG_NUM:function(t,e){t.inboxMsgNum=e},SET_SENT_MSG_NUM:function(t,e){t.sentMsgNum=e},SET_PAGE:function(t,e){t.page=e},SET_PREVENT_PAGINATION:function(t,e){t.preventPagination=e},SET_INBOX_SEARCH:function(t,e){t.inboxSearchKeyword=e},SET_SENT_SEARCH:function(t,e){t.sentSearchKeyword=e}}},hn=new on["a"].Store(mn),fn=hn,pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__list scrollbar"},[0===t.inboxMsgNum?n("div",[t._v(" You have no message."),n("br"),t._v(" Do you want to send a message to someone? Please click "),n("span",{staticClass:"link f-700",on:{click:t.handleSendMessageModal}},[t._v("here")]),t._v(" to start!!! ")]):t._l(t.dataMsgInbox,(function(t){return n("MailInbox",{key:t.id,attrs:{message:t}})}))],2)},vn=[],gn=(n("d81d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("article",{staticClass:"mail-content__item d-flex",class:t.checkUnread(t.message.id)?"":"unread",on:{click:function(e){return t.handleSelectedMail(t.message.id)}}},[i("Avatar",{attrs:{accountId:t.message.from,size:"40"}}),i("div",{staticClass:"content pl-20 pl-md-10 flex-grow-1"},[i("header",{staticClass:"d-flex justify-between mb-10 mb-sm-0 mail-content__item-header"},[i("div",{staticClass:"flex-grow-1 mail-content__item-header__top pr-20"},[i("div",{staticClass:"name title-16 f-700"},[t._v(t._s(t.message.from))]),i("div",{class:{isPrivate:t.message.isPrivate}},[t.message.isPrivate?i("img",{staticClass:"private-message",attrs:{src:n("90dc")}}):t._e(),i("div",{staticClass:"title f-500"},[t._v("Title: "+t._s(t.message.title))])])]),i("div",{staticClass:"text-right f-500"},[i("div",{staticClass:"status-read"},[t.checkUnread(t.message.id)?t._e():i("span",[t._v("Unread")])]),i("div",{staticClass:"date-time no-wrap"},[t._v(" "+t._s(t.message.timestamp.toLocaleString())+" ")])])])]),i("div",{staticClass:"is-hidden"},[t._v(t._s(t.selectedId))])],1)}),wn=[],bn=(n("a630"),n("6062"),{props:["message"],components:{Avatar:J},data:function(){return{readMailId:[],selectedId:null,accountId:null}},mounted:function(){this.getAccountId()},methods:{getAccountId:function(){this.accountId=window.walletConnection.getAccountId()},handleSelectedMail:function(t){this.$store.commit("MESSAGE_CONVERSATION",t),this.selectedId=t;var e=JSON.parse(localStorage.getItem(this.accountId+" inbox"));if(e){var n=Object(j["a"])(e);n.push(t);var i=Array.from(new Set(n));this.readMailId=i}var s=Object(j["a"])(this.readMailId);s.push(t);var a=Array.from(new Set(s));this.readMailId=a,e&&e.includes(t)||localStorage.setItem(this.accountId+" inbox",JSON.stringify(this.readMailId))},checkUnread:function(t){var e=JSON.parse(localStorage.getItem(this.accountId+" inbox"));return!!e&&e.includes(t)}}}),_n=bn,Mn=(n("9ec7"),Object(T["a"])(_n,gn,wn,!1,null,"c0b466a8",null)),Cn=Mn.exports,yn={components:{MailInbox:Cn},data:function(){return{dataMsgInbox:[],accountId:null}},mounted:function(){this.getAccountId(),this.getInboxMsg()},computed:{inboxMsgNum:function(){return this.$store.state.inboxMsgNum},page:function(){return this.$store.state.page},routePathInbox:function(){return"/inbox"===this.$route.path},localPrivateKey:function(){return this.$store.state.localPrivateKey},passwordConfirm:function(){return this.$store.state.passwordConfirm}},watch:{passwordConfirm:function(){this.getInboxMsg()},page:function(){this.getInboxMsg()},inboxMsgNum:function(){this.getInboxMsg(),this.recallInboxMsgNumApi()},localPrivateKey:function(){this.getInboxMsg()},routePathInbox:function(){this.getInboxMsg()}},methods:{handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},getAccountId:function(){this.accountId=window.walletConnection.getAccountId()},getInboxMsg:function(){var t=this;if(0!==this.inboxMsgNum){var e=null;this.passwordConfirm&&this.localPrivateKey&&(e=Object(B["decryptPrivateKeyWithPasswordConfirm"])(this.passwordConfirm,this.localPrivateKey));var n={isLoadFromIpfs:V.a.clientConfig.isSupportIpfs,isInboxMsg:!this.routePathSent,privateKey:null!==e?e.slice(5):null},i=k(this.inboxMsgNum,this.page,20);0===i.fromIndex?this.$store.commit("SET_PREVENT_PAGINATION",!0):this.$store.commit("SET_PREVENT_PAGINATION",!1),window.contract.getInboxMessages({accountId:this.accountId,fromIndex:i.fromIndex,toIndex:i.toIndex}).then((function(e){var i=e.map((function(t){return{baseSite:t.baseSite,expiredTime:t.expiredTime,from:t.from,to:t.to,timestamp:t.timestamp,id:t.id,prevMsgId:t.prevMsgId,title:t.title,data:t.data,isPrivate:["DIRECT-PRI","#IPFS-PRI"].some((function(e){return t.data.includes(e)}))}})),s=i.map((function(e){return t.updateDataMessage(e,n)}));return Promise.all(s)})).then((function(e){var n=Object(j["a"])(e);n.reverse(),t.dataMsgInbox=n}))}},updateDataMessage:function(t,e){return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,V.a.depackMessage(t,e);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()},recallInboxMsgNumApi:function(){this.inboxMsgNum>this.dataMsgInbox.length&&this.getInboxMsg()}}},xn=yn,kn=(n("7175"),Object(T["a"])(xn,pn,vn,!1,null,"165b361e",null)),In=kn.exports,Sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mail-content__list scrollbar"},[0===t.sentMsgNum?n("div",[t._v(" You haven't sent any message."),n("br"),t._v(" Do you want to send a message to someone? Please click "),n("span",{staticClass:"link f-700",on:{click:t.handleSendMessageModal}},[t._v("here")]),t._v(" to start!!! ")]):t._l(t.dataMsgSent,(function(t){return n("MailSent",{key:t.id,attrs:{message:t}})}))],2)},En=[],Pn=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("article",{staticClass:"mail-content__item d-flex",on:{click:function(e){return t.handleSelectedMail(t.message.id)}}},[i("Avatar",{attrs:{accountId:t.message.from,size:"40"}}),i("div",{staticClass:"content pl-20 pl-md-10 flex-grow-1"},[i("header",{staticClass:"d-flex justify-between mb-10 mb-sm-0 mail-content__item-header"},[i("div",{staticClass:"flex-grow-1 mail-content__item-header__top pr-20"},[i("div",{staticClass:"name title-16 f-700"},[t._v("To: "+t._s(t.message.to))]),i("div",{class:{isPrivate:t.message.isPrivate}},[t.message.isPrivate?i("img",{staticClass:"private-message",attrs:{src:n("90dc")}}):t._e(),i("div",{staticClass:"title f-500"},[t._v("Title: "+t._s(t.message.title))])])]),i("div",{staticClass:"text-right f-500",staticStyle:{display:"flex","flex-direction":"column","align-items":"flex-end"}},[i("div",{staticClass:"date-time no-wrap"},[t._v(" "+t._s(t.message.timestamp.toLocaleString())+" ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:this.handleShowCoinIcon&&!t.isReceive,expression:"this.handleShowCoinIcon && !isReceive"}],staticStyle:{position:"relative",width:"min-content"},on:{click:t.handleConfirmClaim,mouseover:function(e){t.showTooltip=!0},mouseleave:function(e){t.showTooltip=!1}}},[i("img",{staticStyle:{width:"20px",height:"20px","max-width":"min-content"},attrs:{src:n("7ff0")}}),i("Tooltip",{attrs:{isShow:t.showTooltip}},[t._v(" You can get back "+t._s(this.handleCalculateReceiveCoin())+" NEAR due to the receiver has not replied in 48 hours!")])],1)])])])],1),i("ConfirmModal",{attrs:{showModal:t.showModalConfirmReceive,handleConfirmFn:t.handleConfirm},on:{closeConfirmModal:function(e){return t.closeConfirmModal(e)}}},[i("div",{style:{fontSize:"15px"}},[t._v("Are you sure to claim back?")])])],1)},An=[],Tn=n("ade3"),Rn={props:["message"],components:{Avatar:J,Tooltip:Ht,ConfirmModal:Re},data:function(){return{accountId:null,showTooltip:!1,checkTime:!1,coinReceive:0,isReceive:!1,handleConfirm:function(){},showModalConfirmReceive:!1}},computed:{realTime:function(){return this.$store.state.realTime},handleShowCoinIcon:function(){var t=_(this.message.moneyInfo.sendBackAmount),e=_(this.message.moneyInfo.receivedAmount),n=_(this.message.moneyInfo.canReceivedAmount),i=n-e;return!!(this.checkTime&&0===Number(t)&&i>0)}},watch:{realTime:{immediate:!0,handler:function(){this.handleCheckTime(this.message.timestamp)}}},methods:Object(Tn["a"])({handleSelectedMail:function(t){this.$store.commit("MESSAGE_CONVERSATION",t)},closeConfirmModal:function(t){this.showModalConfirmReceive=t},handleCheckTime:function(t){if(t&&this.realTime){var e=Yt()(this.realTime).diff(Yt()(t),"hour");this.checkTime=e>48}},handleCalculateReceiveCoin:function(){var t=_(this.message.moneyInfo.receivedAmount),e=_(this.message.moneyInfo.canReceivedAmount),n=Number(e)-Number(t);return n},handleConfirmClaim:function(){this.showModalConfirmReceive=!0,this.handleConfirm=this.handleClaim},handleClaim:function(){var t=this;window.contract.sendBack({msgId:this.message.id}).then((function(e){e?(t.$toast.success("Success receive NEAR!",{timeout:2e3}),t.isReceive=e):(t.$toast.error("Fail receive NEAR!",{timeout:2e3}),t.isReceive=e)}))}},"handleClaim",(function(){var t=this;window.contract.sendBack({msgId:this.message.id}).then((function(e){e?(t.$toast.success("Success receive NEAR!",{timeout:2e3}),t.isReceive=e):(t.$toast.error("Fail receive NEAR!",{timeout:2e3}),t.isReceive=e)}))}))},Nn=Rn,On=(n("0ac3"),Object(T["a"])(Nn,Pn,An,!1,null,"4141fe18",null)),Ln=On.exports,$n={components:{MailSent:Ln},data:function(){return{dataMsgSent:[],readMailId:[],accountId:null}},mounted:function(){this.getAccountId(),this.getSentMsg()},computed:{sentMsgNum:function(){return this.$store.state.sentMsgNum},page:function(){return this.$store.state.page},routePathSent:function(){return"/sent"===this.$route.path},localPrivateKey:function(){return this.$store.state.localPrivateKey},passwordConfirm:function(){return this.$store.state.passwordConfirm}},watch:{passwordConfirm:function(){this.getSentMsg()},page:function(){this.getSentMsg()},sentMsgNum:function(){this.getSentMsg()},localPrivateKey:function(){this.getSentMsg()},routePathSent:function(){this.getSentMsg()}},methods:{handleSendMessageModal:function(){this.$store.state.sendMessageModal.isShow||this.$store.commit("TOGGLE_SEND_MESSAGE_MODAL")},getAccountId:function(){this.accountId=window.walletConnection.getAccountId()},getSentMsg:function(){var t=this;if(0!==this.sentMsgNum){var e=null;this.passwordConfirm&&this.localPrivateKey&&(e=Object(B["decryptPrivateKeyWithPasswordConfirm"])(this.passwordConfirm,this.localPrivateKey));var n={isLoadFromIpfs:V.a.clientConfig.isSupportIpfs,isInboxMsg:!this.routePathSent,privateKey:null!==e?e.slice(5):null},i=k(this.sentMsgNum,this.page,20);0===i.fromIndex?this.$store.commit("SET_PREVENT_PAGINATION",!0):this.$store.commit("SET_PREVENT_PAGINATION",!1),window.contract.getSentMessages({accountId:this.accountId,fromIndex:i.fromIndex,toIndex:i.toIndex}).then((function(e){var i=e.map((function(t){return{baseSite:t.baseSite,expiredTime:t.expiredTime,from:t.from,to:t.to,timestamp:t.timestamp,id:t.id,prevMsgId:t.prevMsgId,title:t.title,data:t.data,moneyInfo:t.moneyInfo,isPrivate:["DIRECT-PRI","#IPFS-PRI"].some((function(e){return t.data.includes(e)}))}})),s=i.map((function(e){return t.updateDataMessage(e,n)}));return Promise.all(s)})).then((function(e){var n=Object(j["a"])(e);n.reverse(),t.dataMsgSent=n}))}},updateDataMessage:function(t,e){return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,V.a.depackMessage(t,e);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))()}}},Kn=$n,jn=(n("16a5"),Object(T["a"])(Kn,Sn,En,!1,null,"1c8ea42d",null)),Fn=jn.exports,Dn=n("6c42");n("da96");i["a"].config.productionTip=!1,i["a"].use(an["a"]),i["a"].use(Dn["a"]);var Gn=[{path:"/",component:In,name:"inbox"},{path:"/inbox",component:In,name:"inbox"},{path:"/sent",component:Fn,name:"sent"}],Un=new an["a"]({mode:"history",routes:Gn});window.nearInitPromise=M().then((function(){new i["a"]({render:function(t){return t(sn)},store:fn,router:Un}).$mount("#app")}))},"5b81":function(t,e,n){t.exports=n.p+"img/lnc-light.c165c156.svg"},"5d14":function(t,e,n){},"5da6":function(t,e,n){},"5f2b":function(t,e,n){t.exports=n.p+"img/logo.5acb612a.svg"},6:function(t,e){},"619a":function(t,e,n){t.exports=n.p+"img/compose-light.efecc01c.svg"},"61f4":function(t,e,n){},"67b5":function(t,e,n){t.exports=n.p+"img/connect-light.eea42ef9.svg"},"6de8":function(t,e,n){},"6e1a":function(t,e,n){"use strict";n("d616")},"6e81":function(t,e,n){t.exports=n.p+"img/compose.48e4e072.svg"},"6f6b":function(t,e,n){},7:function(t,e){},7175:function(t,e,n){"use strict";n("5da6")},"7a16":function(t,e,n){},"7ff0":function(t,e,n){t.exports=n.p+"img/coin.9c8138ed.svg"},8:function(t,e){},"82d7":function(t,e,n){"use strict";n("8459")},8459:function(t,e,n){},"84d3":function(t,e,n){"use strict";n("5648")},"8af7":function(t,e,n){"use strict";n("e3bf")},"8f55":function(t,e,n){t.exports=n.p+"img/sent.e5b883c7.svg"},9:function(t,e){},"90dc":function(t,e,n){t.exports=n.p+"img/privateMsg.d3c34d40.svg"},9253:function(t,e,n){"use strict";n("7a16")},"93e1":function(t,e,n){},"9dc9":function(t,e,n){"use strict";n("b2d9")},"9ec7":function(t,e,n){"use strict";n("f884")},a996:function(t,e,n){"use strict";n("5d14")},ad0b:function(t,e,n){"use strict";n("c787")},af90:function(t,e,n){},b2d9:function(t,e,n){},b385:function(t,e,n){"use strict";n("ff86")},b654:function(t,e,n){(function(t){var s=n("c973").default,a=n("680c").default;n("96cf"),n("d3b7"),n("25f0"),n("e9c4"),n("99af"),n("ddb0"),n("2ca0"),n("ac1f"),n("1276");var o=n("fb08"),r=n("1333"),c=n("bc3a").default,l=n("5928");c.defaults.adapter=n("b50d");n("d485");var u={aesKey:"fc2f83976ad1342659c989ff91bc09d4efb891fd877e77fa03f61006467cff0e",isSupportIpfs:!0};e.clientConfig=u;var d=null;function m(){return h.apply(this,arguments)}function h(){return h=s(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!=d){t.next=4;break}return t.next=3,o.create({host:"ipfs.infura.io",port:5001,protocol:"https",timeout:"1m"});case 3:d=t.sent;case 4:return t.abrupt("return",d);case 5:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function f(t){return p.apply(this,arguments)}function p(){return p=s(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function v(t){return g.apply(this,arguments)}function g(){return g=s(regeneratorRuntime.mark((function e(n){var i,s,o,r,c,l,u,d,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:i=e.sent,s=i.cat(n),o=null,r=!1,c=!1,e.prev=7,u=a(s);case 9:return e.next=11,u.next();case 11:if(!(r=!(d=e.sent).done)){e.next=17;break}h=d.value,o=null==o?h:t.concat(o,h);case 14:r=!1,e.next=9;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](7),c=!0,l=e.t0;case 23:if(e.prev=23,e.prev=24,!r||null==u.return){e.next=28;break}return e.next=28,u.return();case 28:if(e.prev=28,!c){e.next=31;break}throw l;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.abrupt("return",t.from(o));case 34:case"end":return e.stop()}}),e,null,[[7,19,23,33],[24,,28,32]])}))),g.apply(this,arguments)}function w(e){var n=t.from(e,"utf8");return n=r.encrypt(u.aesKey,n),n.toString("base64")}function b(e){if(!e)return"";var n=t.from(e,"base64");return n=r.decrypt(u.aesKey,n),n.toString("utf8")}function _(e,n){var i=t.from(JSON.stringify(e),"utf8");return i=r.encrypt(n,i),i}function M(t,e){var n=r.decrypt(e,t),i=n.toString("utf8");return JSON.parse(i)}function C(){var t="",e="0123456789abcdef";for(i=0;i<64;i++)t+=e.charAt(Math.floor(16*Math.random()));return t}function y(e,n){var i=t.from(e,"base64").toString("utf8"),s=new l(i,"public"),a=s.encrypt(n,"base64");return a}function x(e,n){var i=t.from(e,"base64").toString("utf8"),s=new l(i,"private"),a=t.from(n,"base64"),o=s.decrypt(a,"utf8");return o}function k(t){return I.apply(this,arguments)}function I(){return I=s(regeneratorRuntime.mark((function t(e){var n,i,s,a,o,r,c,l,d,h,f,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={code:1,message:"Unknow error"},t.prev=1,n.title=w(e.title),i=e.type&&"PRIVATE"==e.type,s=u.aesKey,i&&(s=C()),a={content:e.content,attachmentFiles:e.attachmentFiles},t.next=9,_(a,s);case 9:if(o=t.sent,!u.isSupportIpfs){t.next=27;break}return t.next=13,m();case 13:return r=t.sent,t.next=16,r.add(o);case 16:if(c=t.sent,!c||!c.cid){t.next=24;break}return t.next=20,r.pin.add(c.cid);case 20:l=t.sent,l?(i?(d=y(e.keys.sender,s),h=y(e.keys.receiver,s),n.data="#IPFS-PRI:".concat(d,"-").concat(h,"-")+c.cid.toString()):n.data="#IPFS:"+c.cid.toString(),n.code=0,n.message="SUCCESS"):n.message="Unable to pin message on IPFS",t.next=25;break;case 24:n.message="Unable to store data on IPFS";case 25:t.next=30;break;case 27:i?(f=y(e.keys.sender,s),p=y(e.keys.receiver,s),n.data="#DIRECT-PRI:".concat(f,"-").concat(p,"-")+o.toString("base64")):n.data="#DIRECT:"+o.toString("base64"),n.code=0,n.message="SUCCESS";case 30:t.next=36;break;case 32:t.prev=32,t.t0=t["catch"](1),console.error("Error to pack message",t.t0),n.message=t.t0.toString();case 36:return t.abrupt("return",n);case 37:case"end":return t.stop()}}),t,null,[[1,32]])}))),I.apply(this,arguments)}function S(t,e){return E.apply(this,arguments)}function E(){return E=s(regeneratorRuntime.mark((function e(n,i){var s,a,o,r,c,l,d,m,h,p,v,g,w,_,C,y,k,I,S,E,P,A;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s={baseSite:n.baseSite,expiredTime:n.expiredTime,from:n.from,to:n.to,timestamp:new Date(n.timestamp/Math.pow(10,6)),id:n.id,prevMsgId:n.prevMsgId,code:1,message:"Unknown error",title:null,content:null,moneyInfo:n.moneyInfo,isPrivate:n.isPrivate},e.prev=1,s.title=b(n.title),a=n.data,!a){e.next=71;break}if(!a.startsWith("#EXPIRED")){e.next=9;break}n.content="The message has been expired!",e.next=69;break;case 9:if(!a.startsWith("#DIRECT-PRI")){e.next=29;break}if(i&&i.privateKey){e.next=15;break}return s.message="Missing parameters!!!",s.title="Missing Private Key",s.content="Can not decrypt this message",e.abrupt("return",s);case 15:o=a.substring(12).split("-"),r=o[2],c=o[0],l=o[1],d=null,d=i&&i.isInboxMsg?x(i.privateKey,l):x(i.privateKey,c),m=t.from(r,"base64"),h=M(m,d),s.content=h.content,s.attachmentFiles=h.attachmentFiles,s.code=0,s.message="SUCCESS",e.next=69;break;case 29:if(!a.startsWith("#DIRECT")){e.next=39;break}p=a.substring(8),v=t.from(p,"base64"),g=M(v,u.aesKey),s.content=g.content,s.attachmentFiles=g.attachmentFiles,s.code=0,s.message="SUCCESS",e.next=69;break;case 39:if(!a.startsWith("#IPFS-PRI")){e.next=56;break}return w=a.substring(10).split("-"),_=w[2],C=w[0],y=w[1],k=null,k=i&&i.isInboxMsg?x(i.privateKey,y):x(i.privateKey,C),e.next=48,f(_);case 48:I=e.sent,S=M(I,k),s.content=S.content,s.attachmentFiles=S.attachmentFiles,s.code=0,s.message="SUCCESS",e.next=69;break;case 56:if(!a.startsWith("#IPFS")){e.next=68;break}return E=a.substring(6),e.next=60,f(E);case 60:P=e.sent,A=M(P,u.aesKey),s.content=A.content,s.attachmentFiles=A.attachmentFiles,s.code=0,s.message="SUCCESS",e.next=69;break;case 68:s.message="Message is invalid format!!!";case 69:e.next=74;break;case 71:s.content="",s.code=0,s.message="SUCCESS";case 74:e.next=81;break;case 76:e.prev=76,e.t0=e["catch"](1),console.error("Error to depack message",e.t0),s.message=e.t0.toString(),s.content="Can not decrypt this message";case 81:return e.abrupt("return",s);case 82:case"end":return e.stop()}}),e,null,[[1,76]])}))),E.apply(this,arguments)}function P(){var e=new l({b:1024}),n=e.exportKey("public"),i=t.from(n,"utf8").toString("base64"),s=e.exportKey("private"),a=t.from(s,"utf8").toString("base64");return{publicKey:i,privateKey:a}}function A(e){var n=t.from(e,"base64").toString("utf8"),i=new l(n,"private"),s=i.exportKey("public"),a=t.from(s,"utf8").toString("base64");return a}function T(t,e){var n=r.encrypt(t,"TEST-".concat(e));return n}function R(t,e){var n=r.decrypt(t,e);return n}e.packMessage=k,e.depackMessage=S,e.generateRSAKey=P,e.privateKeyToPublicKey=A,e.encryptPrivateKeyWithPasswordConfirm=T,e.decryptPrivateKeyWithPasswordConfirm=R}).call(this,n("1c35").Buffer)},c787:function(t,e,n){},c968:function(t,e,n){},d616:function(t,e,n){},db49:function(t,e,n){var i="app.nearmessage.testnet";function s(t){switch(t){case"production":case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:i,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"development":case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:i,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:i,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org",explorerUrl:"https://explorer.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",VUE_APP_CONTRACT_NAME:"app.nearmessage.testnet",VUE_APP_TIME_CHECK:"60000",BASE_URL:"/"}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:i};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:i,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:i,masterAccount:"test.near"};default:throw Error("Unconfigured environment '".concat(t,"'. Can be configured in src/config.js."))}}t.exports=s},e32e:function(t,e,n){},e3bf:function(t,e,n){},e53b:function(t,e,n){"use strict";n("93e1")},e928:function(t,e,n){},ed78:function(t,e,n){"use strict";n("e928")},f884:function(t,e,n){},fb89:function(t,e,n){t.exports=n.p+"img/lnc.ae13a5ad.svg"},ff86:function(t,e,n){}});
//# sourceMappingURL=index.5c6b05fc.js.map